!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(o){const n=new URL(e,location),r=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((o,a)=>{const s=new URL(e,n);if(self[t].moduleMap[s])return o(self[t].moduleMap[s]);const i=new Blob([`import * as m from '${s}';`,`${t}.moduleMap['${s}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){a(new Error(`Failed to import: ${e}`)),r(c)},onload(){o(self[t].moduleMap[s]),r(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("assets/");function e(){localStorage.setItem("AcceptedWarning","true"),document.querySelector(".warning-modal-wrapper").remove()}(function(){const e=localStorage.getItem("AcceptedWarning");return!!e&&Boolean(e)})()&&e();const t=document.querySelector(".notification"),o=document.querySelector(".notification__text");let n=0;var r,a;function s(e,a){t.classList.remove("notification--"+r.INFO,"notification--"+r.ERROR),0!==n&&clearTimeout(n),t.classList.add("notification--"+a,"notification--show"),o.innerHTML=e,n=setTimeout((()=>{t.classList.remove("notification--show")}),2e3)}(a=r||(r={})).INFO="info",a.ERROR="error";const i=/https:\/\/betterttv.com\/emotes\/([a-z0-9]+)/,c=document.querySelector(".manager-form__emote-list");function l(e){const t=e.split(".")[1],o=atob(t);return JSON.parse(o).id}function d(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}function m(e){return Boolean(e.match(/^[a-zA-Z0-9-_]+\.[a-zA-Z0-9-_]+\.[a-zA-Z0-9-_]+$/))}var u,f;(f=u||(u={})).ADD="PUT",f.REMOVE="DELETE";const p=document.querySelector(".manager-form__progress-bar");function v(e){s("Something went wrong! See console",r.ERROR),console.error(e)}function h(e,t,o){const n=c.value.split("\n").map((e=>{const t=e.match(i);return t?t[1]:null}));if(o.validate){if(!m(t))return void s("Invalid Token",r.ERROR);if(n.length>0&&n.some((e=>!e)))return void s("There are invalid emote urls",r.ERROR)}let a=0;(async function(e,t,o,n){const r=l(t),a="https://api.betterttv.net/3/emotes/{emoteId}/shared/{userId}".replace("{userId}",r);for(const s of o){const o=a.replace("{emoteId}",s),r=await fetch(o,{method:e,headers:new Headers({Authorization:`Bearer ${t}`})});if(204!==r.status)throw`Received status ${r.status} instead of 204`;n(),await d(500)}})(e,t,n,(()=>{a++,function(e){const t=100*e;p.style.background=`linear-gradient(to right, var(--progress-bar-progress) 0% ${t}%, var(--progress-bar-empty) ${t}% 100%)`}(a/n.length)})).then((()=>{s(o.readyMessage,r.INFO),p.removeAttribute("style")})).catch(v)}function R(e){m(e)&&async function(e){const t=l(e),o="https://api.betterttv.net/3/users/{userId}?limited=false".replace("{userId}",t),n=await fetch(o);return(await n.json()).sharedEmotes.map((e=>e.id))}(e).then((t=>{console.log({emoteIds:t}),h(u.REMOVE,e,{readyMessage:"All YOUR emotes were removed",validate:!1})})).catch(v)}window.emoteManager={token:"invalid",setToken(e){setTimeout((()=>{const t=e.value;e.value="",m(t)?(this.token=t,e.remove(),s("The token was pasted!",r.INFO)):s("Invalid Token",r.ERROR)}),1)},add(){var e;e=this.token,h(u.ADD,e,{readyMessage:"All listed emotes were added!",validate:!0})},reset(){R(this.token)},remove(){var e;e=this.token,h(u.REMOVE,e,{readyMessage:"All listed emotes were removed!",validate:!0})},acceptWarning:e};
