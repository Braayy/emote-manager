!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(o){const n=new URL(e,location),r=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((o,i)=>{const a=new URL(e,n);if(self[t].moduleMap[a])return o(self[t].moduleMap[a]);const s=new Blob([`import * as m from '${a}';`,`${t}.moduleMap['${a}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){i(new Error(`Failed to import: ${e}`)),r(c)},onload(){o(self[t].moduleMap[a]),r(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("assets/");const e={token:"invalid",updating:!1};function t(t){e.updating=t}const o=/^([a-z0-9]{24})$/,n=document.querySelector(".manager-form__emote-list");function r(e){const t=e.split(".")[1],o=atob(t);return JSON.parse(o).id}function i(){return n.value.split("\n").filter((e=>e.match(o))).map((e=>e.match(o)[1]))}function a(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}function s(e){return Boolean(e.match(/^[a-zA-Z0-9-_]+\.[a-zA-Z0-9-_]+\.[a-zA-Z0-9-_]+$/))}var c,l;async function u(e,t,o,n){const i=r(t),s="https://api.betterttv.net/3/emotes/{emoteId}/shared/{userId}".replace("{userId}",i);for(const r of o){const o=s.replace("{emoteId}",r),i=await fetch(o,{method:e,headers:new Headers({Authorization:`Bearer ${t}`})});if(204!==i.status)throw`Received status ${i.status} instead of 204`;n(),await a(500)}}(l=c||(c={})).ADD="PUT",l.REMOVE="DELETE";const d=document.querySelector(".notification"),m=document.querySelector(".notification__text");let f=0;var R,p;function w(e,t){d.classList.remove("notification--"+R.INFO,"notification--"+R.ERROR),0!==f&&clearTimeout(f),d.classList.add("notification--"+t,"notification--show"),m.innerHTML=e,f=setTimeout((()=>{d.classList.remove("notification--show")}),2e3)}(p=R||(R={})).INFO="info",p.ERROR="error";const v=document.querySelector(".manager-form__progress-bar");function h(e){const t=100*e;v.style.background=`linear-gradient(to right, var(--progress-bar-progress) 0% ${t}%, var(--progress-bar-empty) ${t}% 100%)`}function g(){v.removeAttribute("style")}async function E(){if(!s(e.token))return void w("Invalid Token",R.ERROR);const o=await async function(e){const t=r(e),o="https://api.betterttv.net/3/users/{userId}?limited=false".replace("{userId}",t),n=await fetch(o);return(await n.json()).sharedEmotes.map((e=>e.id))}(e.token);t(!0);let n=0;await u(c.REMOVE,e.token,o,(()=>{n++,h(n/o.length)})),w("All YOUR emotes were removed!",R.INFO),t(!1),g()}function O(){localStorage.setItem("AcceptedWarning","true"),document.querySelector(".warning-modal-wrapper").remove()}(function(){const e=localStorage.getItem("AcceptedWarning");return!!e&&Boolean(e)})()&&O(),window.onAcceptWarning=function(){O()},window.onAdd=function(){(async function(){if(!s(e.token))return void w("Invalid Token",R.ERROR);const o=i();if(0===o.length)return void w("Emote list is empty or everything is invalid",R.ERROR);if(o.some((e=>!e)))return void w("There are invalid emote ids",R.ERROR);t(!0);let n=0;await u(c.ADD,e.token,o,(()=>{n++,h(n/o.length)})),w("All listed emotes were added!",R.INFO),t(!1),g()})().catch((e=>{w("Something went wrong! See console",R.ERROR),console.error(e)}))},window.onReset=function(){E().catch((e=>{w("Something went wrong! See console",R.ERROR),console.error(e)}))},window.onRemove=function(){(async function(){if(!s(e.token))return void w("Invalid Token",R.ERROR);const o=i();if(0===o.length)return void w("Emote list is empty or everything is invalid",R.ERROR);if(o.some((e=>!e)))return void w("There are invalid emote ids",R.ERROR);t(!0);let n=0;await u(c.REMOVE,e.token,o,(()=>{n++,h(n/o.length)})),w("All listed emotes were removed!",R.INFO),t(!1),g()})().catch((e=>{w("Something went wrong! See console",R.ERROR),console.error(e)}))},window.onPasteToken=function(t){setTimeout((()=>{const o=t.value;t.value="",s(o)?(t.remove(),function(t){e.token=t}(o),w("Token pasted!",R.INFO)):w("Invalid Token",R.ERROR)}),1)};
